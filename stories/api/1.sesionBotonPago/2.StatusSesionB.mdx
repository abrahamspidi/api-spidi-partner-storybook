import { Meta } from '@storybook/blocks';

<Meta title="API/Sesion Boton de Pago/2. Status Sesion B" />

## Status de Sesion de Pago
# 1. Descripción

Este endpoint permite consultar el estado actual de una sesión de pago y sus datos esenciales, generada mediante el botón de pago, ya sea desde una aplicación web o móvil.

Este endpoint es la fuente oficial y confiable para verificar si la sesión de pago creada por la vía de botón de pago, fue completado con éxito (paid) rechazado o fallido (failed) o si expiró (expired).

Una sesión de pago puede crearse mediante un **Botón de pago** o una **Solicitud de pago**, cada una con su propio endpoint de creación. Sin embargo, para **consultar** una sesión de pago —sin importar cómo haya sido creada— se utiliza **el mismo endpoint** de consulta. En la respuesta (`response`), existe un campo "session_origin" que revelerá si fue creada por botón de pago o por solicitud. Por otro lado, el campo **`status`** puede tener un valor adicional: **`failed`**, en los casos donde la sesión fue creada a través de un **Botón de pago**. 

**Nota importante (botón vs solicitud):**

Tras paid, la liquidación al receptor puede tardar unos segundos; en ese caso `receiver_credits` y `receiver_credits_summary` pueden venir null temporalmente. Independientemente de si la liquidación al receptor aún no ha ocurrido, es indispensable notificar al pagador que su pago fue realizado exitosamente y continuar con la entrega del servicio o producto sin ningún problema. La liquidación al receptor es un proceso interno y, aunque puede demorar pocos segundos, o hasta 2 minutos, no existe riesgo de fallo. En esta etapa: el pago ya está confirmado, y se genera una cuenta por cobrar al usuario que constituye un derecho causado e irrevocable según los términos acordados.

Por lo tanto, en caso de que tengas control, no retengas ni retrases la prestación del servicio al pagador mientras esperas la liquidación.

Si necesitas mostrar o procesar datos de la liquidación, consulta el endpoint de status periódicamente hasta que los campos de `receiver_credits` estén presentes. Opcionalmente, si implementaste un webhook, recibirás una notificación automática en tu API cuando la liquidación se haya completado y los datos estén disponibles. 

**NOTA 2:** Recuerda que se incluye el URL del comprobante exitoso, que debe ser mostrado al usuario de una forma u otra.

**Notas sobre pagos con criptomonedas:**

- Si `payment_method` es "crypto", el objeto `crypto_details` contendrá información específica del pago cripto
- Si `payment_method` es distinto a "crypto", entonces `crypto_details` será null
- En caso de pago con crypto, si está en "paid_pending", entonces los objetos `payment_details`, `receiver_credits` y `receiver_credits_summary` estarán presentes con valores null
- Si no se generó un split, entonces el objeto de `receiver_credits` tiene un solo elemento. Si en cambio existió el split, deben haber al menos dos elementos

**Notas importantes:**

* **Backend obligatorio para confirmar pagos:** No asumas `paid` solo por redirección; **consulta este endpoint** desde tu servidor antes de liberar servicios.

* **Liquidación diferida:** Tras `paid`, `receiver_credits` puede estar vacío temporalmente. **No bloquees** la entrega al pagador; actualiza luego vía **webhook** (`payment.paid`/`payment.settled`) o reconsulta hasta completar datos de liquidación.

* **Estados vigentes:** `pending`, `paid`, `expired` y para botones de pago: `failed`.

# 2. Endpoint

Method: **GET**
```
{{baseUrl}}/api/v1/payment-session/{session_id}/status
```

**Headers requeridos:**
- `Authorization: Bearer {token}`
- `Accept: application/json`

**Compatibilidad temporal versión vieja:**
```
{{baseUrl}}/api/v1/payment-session/status/{session_id}
```

# 3. Ejemplo del Request
Method: **GET**
```
{{baseUrl}}/api/v1/payment-session/3ddc4cfb-c09a-43de-92c1-e4a069732e90/status
```

# 4. Tabla de Parámetros del Request

### Campos del Nivel Principal

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b><i>session_id</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>ID de la sesión de pago generada y recibida en el response del endpoint …/payment-session/button. **Formato**: ^[a-zA-Z0-9_-]+$</td></tr>
</table>

*(No hay body ni query params en este endpoint.)*

# 5. Ejemplo de Response 200

Cases: status = `pending | paid | failed | expired`

### **5.1 Caso status = `pending`**

```json
{
  "success": true,
  "message": "Successful query.",
  "data": {
    "session_id": "3ddc4cfb-c09a-43de-92c1-e4a069732e90",
    "session_origin": "button",
    "agreement_id": "btn_1024",
    "status": "pending",
    "currency_reference": "USD",
    "amount_reference": 50.00,
    "identifier_label": "Nombre y Apellido",        
    "identifier": "Federico Coppola",
    "description": "",
    "created_at": "2025-09-18T20:45:00Z",
    "session_payment": {
      "user_message": "Esperando que completes el pago",
      "due_date_link": "2025-10-31T23:59:59Z",
      "expire_behavior_link": "expire",
      "late_notice_message": null
    }
  }
}
```

### **5.2 Caso status = `paid` (liquidación en tránsito: `receiver_credits` vacío)**

```json
{
  "success": true,
  "message": "Successful query.",
  "data": {
    "session_id": "3ddc4cfb-c09a-43de-92c1-e4a069732e90",
    "session_origin": "button",
    "agreement_id": "btn_1024",
    "status": "paid",
    "currency_reference": "USD",
    "amount_reference": 50.00,
    "identifier_label": "Nombre y Apellido",        
    "identifier": "Federico Coppola",
    "description": "",
    "created_at": "2025-09-18T20:45:00Z",
    "session_payment": {
      "payment_method": "immediate_debit",
      "spidi_transaction_id": 643,
      "spidi_transaction_url": "https://mispidi.com/receipt/643",
      "user_message": "Pago exitoso",
      "crypto_details": null,
      "payment_details": {
         "action_date": "2025-09-18T21:00:08Z",
         "bank_name": "BANCO PLAZA",
         "bank_reference_id": "00001440",
         "amount_ves": 6100.56,
         "bcv_rate_usd_ves": 122.0112,
         "bcv_rate_eur_ves": 145.2414,
         "rate_usdt_ves": 183.1112,
         "rate_col_ves": 0.0501
      },
      "receiver_credits": null,
      "receiver_credits_summary": null
    }
  }
}
```

### **5.3 Caso status = `paid` (liquidación completada)**

```json
{
  "success": true,
  "message": "Successful query.",
  "data": {
    "session_id": "3ddc4cfb-c09a-43de-92c1-e4a069732e90",
    "session_origin": "button",
    "agreement_id": "btn_1024",
    "status": "paid",
    "currency_reference": "USD",
    "amount_reference": 50.00,
    "identifier_label": "Nombre y Apellido",        
    "identifier": "Federico Coppola",
    "description": "",
    "created_at": "2025-09-18T20:45:00Z",
    "session_payment": {
      "payment_method": "immediate_debit",
      "spidi_transaction_id": 643,
      "spidi_transaction_url": "https://mispidi.com/receipt/643",
      "user_message": "Pago exitoso",
      "crypto_details": null,
      "payment_details": {
         "action_date": "2025-09-18T21:00:08Z",
         "bank_name": "BANCO PLAZA",
         "bank_reference_id": "00001440",
         "amount_ves": 6100.56,
         "bcv_rate_usd_ves": 122.0112,
         "bcv_rate_eur_ves": 145.2414,
         "rate_usdt_ves": 183.1112,
         "rate_col_ves": 0.0501
      },
      "receiver_credits": [
        {
          "receiver_id": "owner",
          "memo": "propio",         
          "spidi_credit_id": "1122",
          "amount_ves_credited": 6090.56,
          "bank_commissions_ves": 0.00,
          "receive_date": "2025-09-18T21:00:10Z",
          "bank_name": "BANESCO",
          "bank_reference_id": "4555111"
        }
      ],
      "receiver_credits_summary": {
        "total_credits": 1,
        "total_amount_ves_credited": 6090.56,
        "total_bank_commissions_ves": 10.00
      }
    }
  }
}
```

### **5.4 Caso status = `paid` (pago con criptomonedas)**

```json
{
  "success": true,
  "message": "Successful query.",
  "data": {
    "session_id": "3ddc4cfb-c09a-43de-92c1-e4a069732e90",
    "session_origin": "button",
    "agreement_id": "btn_1024",
    "status": "paid",
    "currency_reference": "USD",
    "amount_reference": 50.00,
    "identifier_label": "Nombre y Apellido",        
    "identifier": "Federico Coppola",
    "description": "",
    "created_at": "2025-09-18T20:45:00Z",
    "session_payment": {
      "payment_method": "crypto",
      "spidi_transaction_id": 643,
      "spidi_transaction_url": "https://mispidi.com/receipt/643",
      "user_message": "Pago exitoso",
      "crypto_details": {
        "crypto_wallet_name": "BinancePay",
        "crypto_order_id": "1535",
        "crypto_status": "paid",
        "amount_ves_check": 6100.56,
        "crypto_currency": "USDT",
        "crypto_amount": 1.248,
        "crypto_paid_at": "2025-09-18T21:00:08Z",
        "crypto_wallet_commission": 0.012,
        "crypto_crixto_commission": 0.007
      },
      "payment_details": {
         "action_date": "2025-09-18T21:00:08Z",
         "bank_name": "BANCO PLAZA",
         "bank_reference_id": "00001440",
         "amount_ves": 6100.56,
         "bcv_rate_usd_ves": 122.0112,
         "bcv_rate_eur_ves": 145.2414,
         "rate_usdt_ves": 183.1112,
         "rate_col_ves": 0.0501
      },
      "receiver_credits": [
        {
          "receiver_id": "owner",
          "memo": "propio",         
          "spidi_credit_id": "1122",
          "amount_ves_credited": 6090.56,
          "bank_commissions_ves": 0.00,
          "receive_date": "2025-09-18T21:00:10Z",
          "bank_name": "BANESCO",
          "bank_reference_id": "4555111"
        }
      ],
      "receiver_credits_summary": {
        "total_credits": 1,
        "total_amount_ves_credited": 6090.56,
        "total_bank_commissions_ves": 10.00
      }
    }
  }
}
```

### **5.6 Caso status = `expired`**

```json
{
  "success": true,
  "message": "Successful query.",
  "data": {
    "session_id": "3ddc4cfb-c09a-43de-92c1-e4a069732e90",
    "session_origin": "button",
    "agreement_id": "btn_1024",
    "status": "expired",
    "currency_reference": "USD",
    "amount_reference": 50.00,
    "identifier_label": "Nombre y Apellido",        
    "identifier": "Federico Coppola",
    "description": "",
    "created_at": "2025-09-18T20:45:00Z",
    "session_payment": {
      "user_message": "La sesión expiró por inactividad. Intenta nuevamente.",
      "expired_at": "2025-10-05T14:22:01Z",
      "reason": "manual_expire_due_to_contract_change"
    }
  }
}
```

### **5.7 Caso status = `failed`**

```json
{
  "success": true,
  "message": "Successful query.",
  "data": {
    "session_id": "3ddc4cfb-c09a-43de-92c1-e4a069732e90",
    "session_origin": "button",
    "agreement_id": "btn_1024",
    "status": "failed",
    "currency_reference": "USD",
    "amount_reference": 50.00,
    "identifier_label": "Nombre y Apellido",        
    "identifier": "Federico Coppola",
    "description": "",
    "created_at": "2025-09-18T20:45:00Z",
    "session_payment": {
      "payment_method": "immediate_debit",
      "spidi_transaction_id": 643,
      "spidi_transaction_url": "https://mispidi.com/failed/643",
      "user_message": "Pago fallido clave errada",
      "crypto_details": null,
      "payment_details": {
         "action_date": "2025-09-18T21:00:08Z",
         "bank_name": "BANCO PLAZA",
         "bank_reference_id": "00001440",
         "amount_ves": 6100.56,
         "bcv_rate_usd_ves": 122.0112,
         "bcv_rate_eur_ves": 145.2414,
         "rate_usdt_ves": 183.1112,
         "rate_col_ves": 0.0501
      }
    }
  }
}
```






























# 6. Tabla de Response 200

Cases: status = `pending | paid | failed | expired`

### Campos del Nivel Principal

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b><i>success</i></b></td><td><b><i>boolean</i></b></td><td>✔ Sí</td><td>True si el endpoint se procesó de forma exitosa. False de lo contrario.</td></tr>
<tr><td><b><i>message</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>Mensaje de confirmación legible para humanos.</td></tr>
<tr><td><b><i>data</i></b></td><td><b><i>object</i></b></td><td>✔ Sí</td><td>Objeto con la información de la sesión consultada.</td></tr>
</table>

### 6.1 Subtabla: data

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b><i>session_id</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>ID único de la sesión de pago.</td></tr>
<tr><td><b><i>session_origin</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>Origen de la sesión: "button" o "request".</td></tr>
<tr><td><b><i>agreement_id</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>ID del acuerdo utilizado para la sesión.</td></tr>
<tr><td><b><i>status</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>Estado actual: "pending", "paid", "failed", "expired".</td></tr>
<tr><td><b><i>currency_reference</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>Moneda de referencia: "USD", "VES".</td></tr>
<tr><td><b><i>amount_reference</i></b></td><td><b><i>number</i></b></td><td>✔ Sí</td><td>Monto en la moneda de referencia.</td></tr>
<tr><td><b><i>identifier_label</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Etiqueta del identificador del pagador.</td></tr>
<tr><td><b><i>identifier</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>Identificador del pagador (nombre, email, etc.).</td></tr>
<tr><td><b><i>description</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Descripción del pago.</td></tr>
<tr><td><b><i>created_at</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>Fecha y hora de creación de la sesión de pago (ISO 8601).</td></tr>
<tr><td><b><i>session_payment</i></b></td><td><b><i>object</i></b></td><td>✔ Sí</td><td>Detalles del pago y estado de la sesión.</td></tr>
</table>

### 6.2 Subtabla: session_payment

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b><i>payment_method</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Método de pago: "crypto", "immediate_debit" o "mobile_payment".</td></tr>
<tr><td><b><i>spidi_transaction_id</i></b></td><td><b><i>integer</i></b></td><td>❌ No</td><td>ID de la transacción en Spidi (null si no se ha completado).</td></tr>
<tr><td><b><i>spidi_transaction_url</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>URL del comprobante de pago (null si no se ha completado).</td></tr>
<tr><td><b><i>user_message</i></b></td><td><b><i>string</i></b></td><td>✔ Sí</td><td>Mensaje para mostrar al usuario según el estado.</td></tr>
<tr><td><b><i>crypto_details</i></b></td><td><b><i>object</i></b></td><td>❌ No</td><td>Detalles de pago con criptomonedas (null si no aplica).</td></tr>
<tr><td><b><i>payment_details</i></b></td><td><b><i>object</i></b></td><td>❌ No</td><td>Detalles del pago bancario (null si no aplica).</td></tr>
<tr><td><b><i>receiver_credits</i></b></td><td><b><i>array&lt;object&gt;</i></b></td><td>❌ No</td><td>Listado de créditos/liquidaciones al receptor (null hasta completar liquidación).</td></tr>
<tr><td><b><i>receiver_credits_summary</i></b></td><td><b><i>object</i></b></td><td>❌ No</td><td>Resumen agregado de las liquidaciones al receptor (null hasta completar liquidación).</td></tr>
<tr><td><b><i>due_date_link</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Fecha límite para completar el pago (ISO 8601).</td></tr>
<tr><td><b><i>expire_behavior_link</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Comportamiento al expirar: "expire" o "extend".</td></tr>
<tr><td><b><i>late_notice_message</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Mensaje para mostrar cuando el pago está atrasado.</td></tr>
<tr><td><b><i>expired_at</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Fecha y hora de expiración (ISO 8601).</td></tr>
<tr><td><b><i>reason</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Razón de la expiración o fallo.</td></tr>
</table>

### 6.3 Subtabla: payment_details

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b><i>action_date</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Fecha y hora de la acción del pagador (ISO 8601).</td></tr>
<tr><td><b><i>bank_name</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Nombre del banco del pagador.</td></tr>
<tr><td><b><i>bank_reference_id</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>ID de referencia bancaria del pago.</td></tr>
<tr><td><b><i>amount_ves</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Monto pagado en VES.</td></tr>
<tr><td><b><i>bcv_rate_usd_ves</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Tasa de cambio BCV USD a VES.</td></tr>
<tr><td><b><i>bcv_rate_eur_ves</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Tasa de cambio BCV EUR a VES.</td></tr>
<tr><td><b><i>rate_usdt_ves</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Tasa de cambio USDT a VES.</td></tr>
<tr><td><b><i>rate_col_ves</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Tasa de cambio COP a VES.</td></tr>
</table>

### 6.4 Subtabla: crypto_details

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b><i>crypto_wallet_name</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Nombre del wallet o procesador (ej.: "BinancePay").</td></tr>
<tr><td><b><i>crypto_order_id</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>ID de la orden cripto.</td></tr>
<tr><td><b><i>crypto_status</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Estado del pago cripto: "paid" o "paid_pending".</td></tr>
<tr><td><b><i>amount_ves_check</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Monto verificado en VES.</td></tr>
<tr><td><b><i>crypto_currency</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Moneda cripto utilizada.</td></tr>
<tr><td><b><i>crypto_amount</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Monto pagado en cripto.</td></tr>
<tr><td><b><i>crypto_paid_at</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Fecha y hora de pago en cripto (ISO 8601).</td></tr>
<tr><td><b><i>crypto_wallet_commission</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Comisión del wallet cripto.</td></tr>
<tr><td><b><i>crypto_crixto_commission</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Comisión de Crixto.</td></tr>
</table>

### 6.5 Subtabla: receiver_credits

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b><i>receiver_id</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Identificador del receptor ("owner" o UUID de partner).</td></tr>
<tr><td><b><i>memo</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Nota o memo asociado a la liquidación.</td></tr>
<tr><td><b><i>spidi_credit_id</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>ID de SPIDI de la liquidación al receptor del pago.</td></tr>
<tr><td><b><i>amount_ves_credited</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Monto neto acreditado en VES (descontada la comisión).</td></tr>
<tr><td><b><i>bank_commissions_ves</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Comisión bancaria en VES.</td></tr>
<tr><td><b><i>receive_date</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Fecha y hora en que se acreditó el pago (ISO 8601).</td></tr>
<tr><td><b><i>bank_name</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Banco al que se acreditó el pago.</td></tr>
<tr><td><b><i>bank_reference_id</i></b></td><td><b><i>string</i></b></td><td>❌ No</td><td>Referencia bancaria del receptor del pago.</td></tr>
</table>

### 6.6 Subtabla: receiver_credits_summary

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b><i>total_credits</i></b></td><td><b><i>integer</i></b></td><td>❌ No</td><td>Número total de créditos/liquidaciones realizados.</td></tr>
<tr><td><b><i>total_amount_ves_credited</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Monto total acreditado en VES.</td></tr>
<tr><td><b><i>total_bank_commissions_ves</i></b></td><td><b><i>number</i></b></td><td>❌ No</td><td>Total de comisiones bancarias en VES.</td></tr>
</table>

# 7. Ejemplos de Response ≠ 200

### Error 400 - Bad Request

```json
{
  "success": false,
  "message": "Missing required field: session_id",
  "errors": {
    "session_id": "This field is required."
  }
}
```

### Error 401 - Unauthorized

```json
{
  "success": false,
  "message": "Unauthorized.",
  "errors": {
    "spidi_id": "The credentials are incorrect"
  }
}
```

### Error 403 - Forbidden

```json
{
  "success": false,
  "message": "Forbidden.",
  "errors": {
    "message": "No tienes permisos para esta operación"
  }
}
```

### Error 404 - Not Found

```json
{
  "success": false,
  "message": "Session not found.",
  "errors": {
    "session_id": "The session does not exist or has been deleted"
  }
}
```

### Error 422 - Unprocessable Entity

```json
{
  "success": false,
  "message": "Unprocessable entity.",
  "errors": {
    "session_id": "Invalid session ID format"
  }
}
```

### Error 500 - Internal Server Error

```json
{
  "success": false,
  "message": "Internal server error."
}
```

# 8. Tabla de explicación de cada campo de los distintos Response (errores)

## 8.1 Campos de nivel raíz (errores 4xx/5xx)

<table>
<tr><th>Campo</th><th>Tipo dato</th><th>Descripción</th></tr>
<tr><td><b><i>success</i></b></td><td><b><i>boolean</i></b></td><td>Siempre false en caso de error.</td></tr>
<tr><td><b><i>message</i></b></td><td><b><i>string</i></b></td><td>Resumen legible del error principal.</td></tr>
<tr><td><b><i>errors</i></b></td><td><b><i>objeto | null</i></b></td><td>Detalle por campo (opcional).</td></tr>
</table>

## 8.2 Subtabla: errors (cuando exista)

<table>
<tr><th>Código de error (HTTP)</th><th>Clave (campo)</th><th>Tipo dato</th><th>Descripción</th></tr>
<tr><td>400 Bad Request</td><td><b><i>session_id</i></b></td><td><b><i>string</i></b></td><td>Campo faltante o formato inválido.</td></tr>
<tr><td>401 Unauthorized</td><td><b><i>spidi_id</i></b></td><td><b><i>string</i></b></td><td>El comercio no coincide con las credenciales proporcionadas.</td></tr>
<tr><td>403 Forbidden</td><td><b><i>message</i></b></td><td><b><i>string</i></b></td><td>No tienes permisos para esta operación.</td></tr>
<tr><td>404 Not Found</td><td><b><i>session_id</i></b></td><td><b><i>string</i></b></td><td>La sesión no existe o ha sido eliminada.</td></tr>
<tr><td>422 Unprocessable Entity</td><td><b><i>session_id</i></b></td><td><b><i>string</i></b></td><td>Formato de session_id inválido.</td></tr>
<tr><td>500 Internal Server Error</td><td><b><i>message</i></b></td><td><b><i>string</i></b></td><td>Error interno del servidor.</td></tr>
</table>

