import { Meta } from '@storybook/blocks';

<Meta title="API-SPIDI/Parada/2. Info Parada" />

# 1. Descripción

Este endpoint permite consultar los detalles de una parada previamente creada en SPIDI y solo sus enlaces activos.

# 2. Endpoint

Method: **GET**
```
{{baseUrl}}/api/v1/ext/payment-stops/{stop_id}
```

# 3. Ejemplo del Request

Method: **GET**
```
{{baseUrl}}/api/v1/ext/payment-stops/7f8b2c6a-4d19-45df-9a10-3e872aa812c1
```

# 4. Tabla de Parámetros del Request

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b>stop_id</b></td><td><b>string (UUID)</b></td><td>✅ Sí</td><td>Identificador único de la parada (UUID).</td></tr>
</table>

# 5. Ejemplo de Response 200

```json
{
  "success": true,
  "message": "Payment stop details retrieved successfully.",
  "data": {
    "stop_id": "7f8b2c6a-4d19-45df-9a10-3e872aa812c1",
    "stop_url": "https://pay.spidi.com/stop/7f8b2c6a",
    "internal_reference": "USER-2025-0931",
    "stop_title": "Caja Principal - Suscripción Premium",
    "empty_state_message": "Actualmente no tienes pagos pendientes.",
    "created_at": "2025-02-10T15:42:00Z",
    "links_active": [
      {
        "session_id": "21f43a2b-d9ff-42d2-87ce-559bdaf1f901",
        "payment_url": "https://pay.spidi.com/21f43a2b-d9ff-42d2-87ce-559bdaf1f901",
        "status": "pending",
        "amount": 15.50,
        "currency_reference": "USD",
        "amount_ves": 1900.00,
        "due_date_link": "2025-03-01T00:00:00Z",
        "expire_behavior_link": "keep_active",
        "late_notice_message": "Tu servicio está inactivo. Realiza el pago ahora para recuperar la continuidad de tu suscripción."
      }
    ]
  }
}
```

# 6. Tabla de Response 200

## Campos del Nivel Principal

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b>success</b></td><td>boolean</td><td>✅ Sí</td><td><b>Generado.</b> True si el endpoint se proceso de forma exitosa. False de lo contrario.</td></tr>
<tr><td><b>message</b></td><td>string</td><td>✅ Sí</td><td><b>Generado.</b> Mensaje de confirmación legible para humanos.</td></tr>
<tr><td><b>data</b></td><td>[objeto]</td><td>✅ Sí</td><td><b>Generado.</b> Lista del objeto con la información de las paradas creadas.</td></tr>
</table>

### 6.1 Subtabla: Response 200 → data

<table>
<tr><th>results.x</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b>stop_id</b></td><td><b>string/ null</b></td><td>✅ Sí</td><td><b>Generado.</b> Identificador de la Parada SPIDI creada.</td></tr>
<tr><td><b>stop_url</b></td><td><b>string/ null</b></td><td>✅ Sí</td><td><b>Generado.</b> URL permanente de la parada individual.</td></tr>
<tr><td><b>internal_reference</b></td><td><b>string</b></td><td>✅ Sí</td><td><b>Eco.</b></td></tr>
<tr><td><b>stop_title</b></td><td><b>string</b></td><td>✅ Sí</td><td><b>Eco.</b></td></tr>
<tr><td><b>empty_state_message</b></td><td><b>string</b></td><td>❌ No</td><td><b>Eco.</b></td></tr>
<tr><td><b>status</b></td><td><b>string</b></td><td>✅ Sí</td><td><b>Eco + transformado.</b> <b><i>"active"</i></b> (por defecto) o <b><i>"disabled"</i></b> según el request.</td></tr>
<tr><td><b>created_at</b></td><td><b>string</b></td><td>✅ Sí</td><td>Fecha y hora de creación (ISO 8601).</td></tr>
<tr><td><b>links_active</b></td><td><b>[objeto]</b></td><td>❌ No</td><td><b>Generado.</b> Lista de enlaces activos en la parada.</td></tr>
</table>

### 6.2 Subtabla: Response 200 → data.links_active

<table>
<tr><th>results.x</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b>session_id</b></td><td><b>string</b></td><td>✅ Sí</td><td><b>Generado.</b> Identificador único de la sesión de pago creada.</td></tr>
<tr><td><b>payment_url</b></td><td><b>string</b></td><td>✅ Sí</td><td><b>Generado.</b> Link "URL" donde el usuario puede ser redirigido para realizar el pago, sin pasar por la parada. En caso de haber creado parada, se recomienda suministrar al pagador el **stop_url**</td></tr>
<tr><td><b>status</b></td><td><b>string</b></td><td>✅ Sí</td><td>Estado del enlace: <b><i>pending</i></b>, <b><i>paid</i></b>, <b><i>expired</i></b></td></tr>
<tr><td><b>currency_reference</b></td><td><b>string</b></td><td>✅ Sí</td><td>Moneda referencia que se usa como base para calcular el monto real en bolívares. Opciones: <b><i>"USD"</i></b>, <b><i>"EUR"</i></b>, <b><i>"COP"</i></b>. Si el monto en bolívares es fijo y no se desea indexar, se debe poner <b><i>"VES"</i></b>.</td></tr>
<tr><td><b>amount</b></td><td><b>number</b></td><td>✅ Sí</td><td>Monto total en la moneda indicada por currency_reference (2 decimales).</td></tr>
<tr><td><b>amount_ves</b></td><td><b>number</b></td><td>✅ Sí</td><td><b>Generado.</b> Monto calculado en bolívares al momento de la creación de la sesión de pago. Si la moneda referencia que se usó fue distinta a "VES", entonces este amount_ves irá cambiando a medida que cambie la tasa oficial.</td></tr>
<tr><td><b>due_date_link</b></td><td><b>string (ISO 8601)</b></td><td>❌ No</td><td>Fecha y hora límite (Venezuela) de vencimiento. Si se alcanza, el enlace se comportará como se elija en campo: **expire_behavior_link**</td></tr>
<tr><td><b>expire_behavior_link</b></td><td><b>string</b></td><td>❌ No</td><td>Define qué le ocurre al enlace al vencer el due_date_link. Valores posibles: <b><i>"expire"</i></b>: el enlace queda expirado. Si hay una parada asociada, se debe generar un nuevo enlace y asociar a la parada. <b><i>"keep_active"</i></b>: el enlace sigue vigente, pero se muestra una advertencia. Esto es ideal cuando no hay penalización en costo, pero sí en servicio.</td></tr>
<tr><td><b>late_notice_message</b></td><td><b>string</b></td><td>❌ No</td><td>Si posterior a la fecha de vencimiento el enlace sigue activo (keep_active), se mostrará el mensaje al pagador que se defina en este campo. Ejemplo: "Tu servicio está inactivo. Realiza el pago ahora para recuperar la continuidad de tu suscripción."</td></tr>
</table>

### 

### 

# 7. Ejemplos de Response ≠ 200

### Error 404 - Not Found
```json
{
  "success": false,
  "message": "Payment stop not found.",
  "errors": {
    "stop_id": "No payment stop exists with the provided stop_id."
  }
}
```

# 8. Tabla de Errores

<table>
<tr><th>Campo</th><th>Tipo</th><th>Requerido</th><th>Descripción</th></tr>
<tr><td><b>success</b></td><td><b>boolean</b></td><td>✅ Sí</td><td>Siempre false en caso de error.</td></tr>
<tr><td><b>message</b></td><td><b>string</b></td><td>✅ Sí</td><td>Resumen legible del error principal.</td></tr>
<tr><td><b>errors</b></td><td><b>objeto | null</b></td><td>❌ No</td><td>Detalle por campo (opcional).</td></tr>
</table>
