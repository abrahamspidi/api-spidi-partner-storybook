import { Meta } from '@storybook/blocks';

<Meta title="API-MAP/Crixto/Mapeo Spidi/Sesion Cripto/2. Crear Sesion Cripto" />

# 1. **Crear sesión de pago cripto**

### **1\. SPIDI API** 

**Endpoint:**  
`POST /api/payment-session/crypto-binance`

* **Descripción:**  
   Crea una nueva sesión de pago cripto, orquestando la lógica interna de SPIDI y consumiendo el endpoint de Crixto para generar la orden de pago correspondiente.

---

## **Tabla resumen de mapeo de endpoints**

## Permite crear una sesión de pago cripto. 

POST `{{baseUrl}}/api/v1/payment-session/crypto`

### **2\. de campos del request**

| Campo | Tipo | Requerido | Descripción | Ejemplo |
| ----- | ----- | ----- | ----- | ----- |
| amount\_ves | number | Sí | Monto en VES a cobrar. | 150.00 |
| webhook\_url | string | No | URL para notificación de cambios de estado. | "https://..." |
| spidi\_id | string | Sí | Identificador único SPIDI (UUID). | "a966..." |
| session\_id | string | Sí | ID único de la sesión SPIDI. | "3ddc..." |

---

#### **Ejemplo de request**

```json
{  
  "amount\_ves": 150.00,  
  "webhook\_url": "https://miapi.com/spidi/webhook",  
  "spidi\_id": "a966ce0d-3af3-415d-ba86-1db5a1c21cf0",  
  "pos\_type": 1,  
  "session\_id": "098ace94-ce70-4203-abc3-80e20bb6e4c6"  
}
```

**SPIDI responde:**

```json
{  
  "success": true,  
  "message": "Sesión de pago cripto creada exitosamente.",  
  "payment\_type": "1",  
  "data": {  
    "crypto\_order\_id": "392",  
    "amount": 150.00,  
    "spidi\_id": "a966ce0d-3af3-415d-ba86-1db5a1c21cf0",  
    "status": "pending",  
    "crypto\_payment\_url": "https://app.binance.com/qr/dplkb615f1ac71dc41f39b11c96bcb5719f1",  
    "crypto\_payment\_qr": "data:image/png;base64,iVBORw0K…SuQmCC",  
    "webhook\_url": "https://miapi.com/spidi/webhook",  
    "session\_id": "098ace94-ce70-4203-abc3-80e20bb6e4c6"  
  }  
}
```

| Campo | Tipo | Descripción |
| ----- | ----- | ----- |
| crypto\_order\_id | string | ID de la orden en Crixto. |
| amount | number | Monto de la orden. |
| spidi\_id | string | ID de SPIDI/serial usado para crear la orden. |
| status | string | Estado actual de la orden ("pending", "paid", etc.). |
| crypto\_payment\_url | string | URL para realizar el pago en BinancePay. |
| crypto\_payment\_qr | string | Imagen QR en base64 para pago rápido. |
| webhook\_url | string | Webhook registrado en la orden (si aplica). |
| session\_id | string | ID de la sesión original en SPIDI. |